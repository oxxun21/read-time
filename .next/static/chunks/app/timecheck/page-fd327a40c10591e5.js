(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[452],{4045:function(e,t,i){Promise.resolve().then(i.bind(i,5899))},5899:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return Calender}});var r=i(7437),n=i(2265),a=i(8672),o=i(2067),l=i.n(o),s=i(9731),m=i.n(s);function Timeform(e){let{value:t,record:i,setRecord:a}=e,o=(0,n.useRef)(),s=(0,n.useRef)(),[c,d]=(0,n.useState)(!1),fetchRecord=async(e,t,i)=>{try{let r=await fetch(e,{method:t,headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!r.ok){alert("Time Record 기록 중 문제가 발생하였습니다.");let e=await r.json();throw Error(e.message)}let n=await r.json();a(n),alert("".concat("POST"===t?"기록":"수정"," 완료!"))}catch(e){console.error(e)}finally{d(!1)}},handleSubmit=async e=>{e.preventDefault();let r=o.current.value,n=s.current.value,a=r.toString().padStart(2,"0"),m=n.toString().padStart(2,"0"),u="".concat(a,":").concat(m);if("00"===a&&"00"===m){alert("시간을 입력해주세요!");return}c||(d(!0),i&&0!==i.length?fetchRecord("/api/timerecord/edit","PATCH",{_id:i[0]._id,time:u}):fetchRecord("/api/timerecord","POST",{date:l()(t).format("YYYY-MM-DD"),time:u}),o.current.value="",s.current.value="")},handleTimeDelete=async()=>{if(!c){d(!0);try{let e=await fetch("/api/timerecord/remove",{method:"DELETE",body:JSON.stringify({_id:i[0]._id})});if(!e.ok){alert("Time Record 삭제 중 문제가 발생하였습니다.");let t=await e.json();throw Error(t.message)}let t=await e.json();a(t),alert("삭제 완료!")}catch(e){console.error(e)}finally{d(!1)}}};return(0,r.jsxs)("section",{className:m().timeSection,children:[(0,r.jsx)("h2",{children:"오늘의 독서 시간 기록"}),(0,r.jsxs)("form",{onSubmit:handleSubmit,className:m().timeForm,children:[(0,r.jsxs)("p",{children:[l()(t).format("YYYY-MM-DD")," 기록"]}),(0,r.jsx)("p",{className:m().info,children:"캘린더를 눌러 수정과 삭제를 할 수 있어요."}),(0,r.jsxs)("div",{className:m().tiemInputDiv,children:[(0,r.jsxs)("div",{className:m().timeInput,children:[(0,r.jsx)("input",{type:"number",id:"hours",ref:o,min:"0",max:"23",placeholder:"0 ~ 23 입력"}),(0,r.jsx)("label",{htmlFor:"hours",children:"시간"})]}),(0,r.jsxs)("div",{className:m().timeInput,children:[(0,r.jsx)("input",{type:"number",id:"minutes",ref:s,min:"0",max:"59",placeholder:"0 ~ 59 입력"}),(0,r.jsx)("label",{htmlFor:"minutes",children:"분"})]})]}),(0,r.jsxs)("div",{className:m().timeBtnDiv,children:[i.length>=1&&(0,r.jsx)("button",{type:"button",onClick:handleTimeDelete,className:m().timeRemove,children:"삭제하기"}),(0,r.jsx)("button",{type:"submit",children:"저장하기"})]})]})]})}function Calender(){let e;let[t,i]=(0,n.useState)(new Date),[o,s]=(0,n.useState)([]);return(0,n.useEffect)(()=>{let dataFetch=async()=>{try{let e=await fetch("/api/getrecord",{cache:"no-store"});if(!e.ok){alert("Time Record를 불러오던 중 문제가 발생하였습니다.");let t=await e.json();throw Error(t.message)}let t=await e.json();s(t)}catch(e){console.error(e)}};dataFetch()},[]),o&&(e=o.map(e=>e.date)),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("section",{children:(0,r.jsx)(a.ZP,{locale:"ko",onChange:i,value:t,next2Label:null,prev2Label:null,tileContent:e=>{let{date:t}=e,i=[];if(o){let e=l()(t).format("YYYY-MM-DD");for(let t of o)t.date===e&&i.push((0,r.jsx)("p",{children:t.time},t._id))}return(0,r.jsx)("div",{children:i})},showNeighboringMonth:!1,formatDay:(e,t)=>l()(t).format("DD"),tileClassName:i=>{let{date:r,view:n}=i,a=l()(r).format("YYYY-MM-DD"),s=[];return o&&e.find(e=>e===a)&&s.push("highlight"),a===l()(t).format("YYYY-MM-DD")&&s.push("selected"),s.join(" ")}})}),(0,r.jsx)(Timeform,{value:t,record:o?o.filter(e=>e.date===l()(t).format("YYYY-MM-DD")):[],setRecord:s})]})}},9731:function(e){e.exports={timeSection:"timeform_timeSection__kxS4w",info:"timeform_info__xQjZK",timeForm:"timeform_timeForm__2hW9g",tiemInputDiv:"timeform_tiemInputDiv__uCjkv",timeInput:"timeform_timeInput__PSVgT",timeBtnDiv:"timeform_timeBtnDiv__lYNWS",timeRemove:"timeform_timeRemove__XMidZ"}}},function(e){e.O(0,[990,486,971,864,744],function(){return e(e.s=4045)}),_N_E=e.O()}]);